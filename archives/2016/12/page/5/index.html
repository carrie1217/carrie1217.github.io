<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description" content="欢迎大家来到我的博客，希望可以帮到你们，很高兴认识你们。我的github地址：https:github.com/kevin1202"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>Kevin博客 - 梦想还是要有的，万一实现了呢？</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><div class="page-header"><div class="background"><img src="/default_images/page_background.jpg"></div><div class="author"><div class="head"><img src="/default_images/author_head.gif"></div><h3 class="name">Kevin</h3><p class="signature">梦想还是要有的，万一实现了呢？</p></div></div><ul class="post-list"><li> <p class="date">2016年12月5日</p><div class="no-title"><ol>
<li>禁用PullToRefreshListView(listview)默认的快速滑动功能<br><code>listView.getRefreshableView().setOverScrollMode(View.OVER_SCROLL_NEVER);</code></li>
</ol>
</div><ul class="meta"><li><i class="icon icon-author"></i>Kevin</li><li><i class="icon icon-clock"></i>0 Minutes</li><li><i class="icon icon-category"></i></li></ul></li><li> <p class="date">2016年12月5日</p><div class="no-title"><h2 id="未呼出键盘输入框不要闪烁"><a href="#未呼出键盘输入框不要闪烁" class="headerlink" title="未呼出键盘输入框不要闪烁"></a>未呼出键盘输入框不要闪烁</h2><p>在根布局中添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">android:focusableInTouchMode=&quot;true&quot;</div></pre></td></tr></table></figure>
<p>动态设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ivClear.setVisibility(View.GONE);</div><div class="line">etDetail.clearFocus();</div><div class="line">rootView.requestFocus();</div><div class="line">rootView.setFocusableInTouchMode(true);</div><div class="line">rootView.setFocusable(true);</div></pre></td></tr></table></figure>
<h2 id="监听键盘弹出和隐藏事件"><a href="#监听键盘弹出和隐藏事件" class="headerlink" title="监听键盘弹出和隐藏事件"></a>监听键盘弹出和隐藏事件</h2><p>目前大概有<a href="http://toughcoder.net/blog/2015/10/09/android-trick-detect-soft-keyboard-show-slash-hide/" target="_blank" rel="external">四种解决键盘弹出和隐藏事件的方法</a>，其中有三种方法是受限的，当activity的属性windowSoftInputMode设置成adjustPan或者adjustResize时这种方法就失效了。因为这二种情况软键盘弹起时，布局是不会发生变化的，二种height值是一样的，自然无法分辨。<br>只有第四种方法时相对完美的，不受activity的属性windowSoftInputMode的值的影响。下面终点来说下这种方法的<a href="http://stackoverflow.com/a/33062760/3962551" target="_blank" rel="external">具体内容</a></p>
<h2 id="计算根布局的高度差"><a href="#计算根布局的高度差" class="headerlink" title="计算根布局的高度差"></a>计算根布局的高度差</h2><p>判断的依据是根布局与DectorView之间的差值，在正常情况下应该等于status bar高度与action bar高度之和。当软键盘弹起时则会大于此值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">private boolean isKeyboardShown(View rootView) &#123;</div><div class="line">        final int softKeyboardHeight = 100;</div><div class="line">        Rect r = new Rect();</div><div class="line">        rootView.getWindowVisibleDisplayFrame(r);</div><div class="line">        DisplayMetrics dm = rootView.getResources().getDisplayMetrics();</div><div class="line">        int heightDiff = rootView.getBottom() - r.bottom;</div><div class="line">        return heightDiff &gt; softKeyboardHeight * dm.density;</div><div class="line">&#125;</div><div class="line"></div><div class="line">globalLayoutListener = new ViewTreeObserver.OnGlobalLayoutListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onGlobalLayout() &#123;</div><div class="line">                if (!keyboardShown(etComment.getRootView())) &#123;</div><div class="line">                    // keyboard hidden</div><div class="line">                    if (!emojPanelShown) &#123;</div><div class="line">                        mface_container.setVisibility(View.GONE);</div><div class="line">                    &#125;</div><div class="line">                &#125; else &#123;</div><div class="line">                    // keyboard shown</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line"> </div><div class="line">etComment.getViewTreeObserver().addOnGlobalLayoutListener(globalLayoutListener);</div></pre></td></tr></table></figure>
<p><strong>注意</strong>：要记得把注册的GlobalLayoutListener再反注册掉。</p>
<h2 id="按下返回键后键盘消失但是onBackPressed方法没有被调用"><a href="#按下返回键后键盘消失但是onBackPressed方法没有被调用" class="headerlink" title="按下返回键后键盘消失但是onBackPressed方法没有被调用"></a>按下返回键后键盘消失但是onBackPressed方法没有被调用</h2><p>这是因为键盘“吃掉”了这个事件，可以通过自定义EditText的方式来处理<br>参见<a href="http://stackoverflow.com/a/5993196/3962551" target="_blank" rel="external">http://stackoverflow.com/a/5993196/3962551</a></p>
</div><ul class="meta"><li><i class="icon icon-author"></i>Kevin</li><li><i class="icon icon-clock"></i>4 Minutes</li><li><i class="icon icon-category"></i></li></ul></li><li> <p class="date">2016年12月5日</p><div class="no-title"><ol>
<li>目前发现有问题的机型有，SMT1和华为</li>
<li>在账户输入框输入时，点击输入框，键盘出现，logo可以正确消失但是异常表现为，<ul>
<li>当输入文字时，logo再次出现，键盘盖住了密码输入框</li>
</ul>
</li>
</ol>
</div><ul class="meta"><li><i class="icon icon-author"></i>Kevin</li><li><i class="icon icon-clock"></i>0 Minutes</li><li><i class="icon icon-category"></i></li></ul></li></ul><ul class="pagination"><li class="link"><a href="/archives/2016/12/page/4/"><i class="icon icon-arror-left"></i></a></li><li class="current"><a>5</a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/kevin1202" title="GitHub" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/u/5052645262" title="Weibo" target="_blank"><i class="icon icon-weibo"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2016 Kevin博客</p></div></div></body></html>